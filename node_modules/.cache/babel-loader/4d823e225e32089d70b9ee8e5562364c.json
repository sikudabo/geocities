{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/simeonikudabo/Downloads/geocities/src/components/ThreadComponent.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport TextField from '@material-ui/core/TextField';\nimport axios from 'axios';\nimport Typography from '@material-ui/core/Typography';\nimport Paper from '@material-ui/core/Paper';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport Avatar from '@material-ui/core/Avatar';\nimport swal from 'sweetalert';\nimport { connect } from 'react-redux';\nimport { useHistory, useParams } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport IconButton from '@material-ui/core/IconButton';\nimport Icon from '@mdi/react';\nimport { mdiSend, mdiDelete } from '@mdi/js';\nconst useStyles = makeStyles(() => ({\n  topMarg: {\n    marginTop: 100\n  },\n  paper: {\n    maxWidth: 600,\n    margin: 'auto'\n  },\n  formMarg: {\n    marginTop: 40\n  }\n}));\n\nfunction ThreadComponent(props) {\n  _s();\n\n  const classes = useStyles();\n  const params = useParams();\n  const history = useHistory();\n  const gridRef = useRef();\n  const [msg, setMsg] = useState(''); //Variable and setter for the chat message we send.\n\n  const [msgDeleting, setMsgDeleting] = useState(false); //Variable and setter to disable buttons when msg is sending or deleting.\n\n  const [thread, setThread] = useState(null); //Variable and setter for the message thread we receive from the server.\n\n  useEffect(() => {\n    //First check to see if the user is null. Go to login page if they are. \n    if (props.user === null) {\n      swal('Uh Oh!', 'You must be logged in to view a message thread!', 'error');\n      history.push('/');\n    } else {\n      return axios({\n        method: 'GET',\n        url: `http://192.168.0.17:3001/api/grab/thread/${params.uniqueThreadId}`\n      }).then(response => {\n        if (response.data === 'no thread') {\n          swal('Uh Oh!', 'That message thread cannot be found!', 'error');\n          history.goBack(1);\n        } else {\n          props.dispatch({\n            type: 'user/updateUser',\n            payload: response.data.user\n          });\n          props.dispatch({\n            type: 'ThemeChange',\n            payload: response.data.user.profileTheme\n          });\n          setThread([...response.data.thread]);\n        }\n      });\n    }\n  });\n\n  function timeDifference(date2, dateString) {\n    //This function will return whether or not we display something like \"2 hrs ago\" \"20 min ago\" or the date string for a thread\n    let date1 = Date.now();\n    let difference = date1 - date2;\n    let daysDifference = Math.floor(difference / 1000 / 60 / 60 / 24);\n    let hoursDifference = Math.floor(difference / 1000 / 60 / 60);\n    let minutesDifference = Math.floor(difference / 1000 / 60);\n    let secondsDifference = Math.floor(difference / 1000);\n\n    if (daysDifference > 0) {\n      return dateString;\n    } else if (hoursDifference > 0 && hoursDifference < 23) {\n      return `${hoursDifference} hr ago`;\n    } else if (minutesDifference > 0 && minutesDifference < 60) {\n      return `${minutesDifference} min ago`;\n    } else if (minutesDifference === 0) {\n      return `${secondsDifference} secs ago`;\n    } else {\n      return dateString;\n    }\n  }\n\n  if (props.user !== null) {\n    return /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      className: classes.topMarg,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 12,\n        children: thread !== null && thread.messages.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: thread.messages.map((message, index) => /*#__PURE__*/_jsxDEV(Paper, {\n            elevation: 3,\n            className: classes.paper,\n            children: /*#__PURE__*/_jsxDEV(ListItem, {\n              alignItems: \"flex-start\",\n              children: [/*#__PURE__*/_jsxDEV(ListItemAvatar, {\n                children: /*#__PURE__*/_jsxDEV(Avatar, {\n                  src: `http://192.168.0.17:3001/api/get/avatar/by/id/${message.senderUniqueUserId}`,\n                  alt: `${message.senderUsername}`,\n                  title: `${message.senderUsername}`,\n                  onClick: e => history.push(`/geouser/${message.senderUniqueUserId}`)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 124,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 123,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(ListItemText, {\n                primary: /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(Typography, {\n                    variant: \"h6\",\n                    component: \"h6\",\n                    children: message.senderUsername\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 134,\n                    columnNumber: 53\n                  }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                    variant: \"subtitle2\",\n                    component: \"span\",\n                    color: \"textSecondary\",\n                    children: timeDifference(message.utcTime, message.dateString)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 140,\n                    columnNumber: 53\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 133,\n                  columnNumber: 49\n                }, this),\n                secondary: /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body1\",\n                  component: \"p\",\n                  children: message.msg\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 150,\n                  columnNumber: 49\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 131,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(ListItemSecondaryAction, {\n                children: /*#__PURE__*/_jsxDEV(IconButton, {\n                  color: \"primary\",\n                  children: /*#__PURE__*/_jsxDEV(Icon, {\n                    path: mdiDelete,\n                    size: 1,\n                    title: \"Message delete\",\n                    \"aria-label\": \"Message delete\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 162,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 159,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 37\n            }, this)\n          }, index.toString(), false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 33\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: gridRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 12,\n        className: classes.formMarg,\n        children: /*#__PURE__*/_jsxDEV(TextField, {\n          label: \"Message\",\n          value: msg,\n          onChange: e => setMsg(e.target.value),\n          color: \"primary\",\n          variant: \"outlined\",\n          placeholder: \"Send message...\",\n          helperText: \"Send a message to this user\",\n          inputLabelProps: {\n            shrink: true\n          },\n          InputProps: {\n            endAdornment: /*#__PURE__*/_jsxDEV(InputAdornment, {\n              position: \"end\",\n              children: /*#__PURE__*/_jsxDEV(IconButton, {\n                \"aria-label\": \"Message send button\",\n                color: \"primary\",\n                children: /*#__PURE__*/_jsxDEV(Icon, {\n                  path: mdiSend,\n                  size: 2\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 206,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 202,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 201,\n              columnNumber: 31\n            }, this)\n          },\n          multiline: true,\n          rows: 4,\n          fullWidth: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(Backdrop, {\n      open: true,\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n        color: \"primary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 13\n    }, this);\n  }\n}\n\n_s(ThreadComponent, \"RQF9JXYRlEudI2rxpnXcuAs53Uc=\", false, function () {\n  return [useStyles, useParams, useHistory];\n});\n\n_c = ThreadComponent;\n\nfunction mapStateToProps(state) {\n  return {\n    user: state.userReducer.user,\n    primary: state.userThemeReducer.primary\n  };\n}\n\nexport default connect(mapStateToProps)(ThreadComponent);\n\nvar _c;\n\n$RefreshReg$(_c, \"ThreadComponent\");","map":{"version":3,"sources":["/Users/simeonikudabo/Downloads/geocities/src/components/ThreadComponent.js"],"names":["React","useState","useEffect","useRef","Grid","TextField","axios","Typography","Paper","ListItem","ListItemAvatar","ListItemText","ListItemSecondaryAction","Avatar","swal","connect","useHistory","useParams","makeStyles","Backdrop","CircularProgress","InputAdornment","IconButton","Icon","mdiSend","mdiDelete","useStyles","topMarg","marginTop","paper","maxWidth","margin","formMarg","ThreadComponent","props","classes","params","history","gridRef","msg","setMsg","msgDeleting","setMsgDeleting","thread","setThread","user","push","method","url","uniqueThreadId","then","response","data","goBack","dispatch","type","payload","profileTheme","timeDifference","date2","dateString","date1","Date","now","difference","daysDifference","Math","floor","hoursDifference","minutesDifference","secondsDifference","messages","length","map","message","index","senderUniqueUserId","senderUsername","e","utcTime","toString","target","value","shrink","endAdornment","mapStateToProps","state","userReducer","primary","userThemeReducer"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport TextField from '@material-ui/core/TextField';\nimport axios from 'axios';\nimport Typography from '@material-ui/core/Typography';\nimport Paper from '@material-ui/core/Paper';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport Avatar from '@material-ui/core/Avatar';\nimport swal from 'sweetalert';\nimport { connect } from 'react-redux';\nimport { useHistory, useParams } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport IconButton from '@material-ui/core/IconButton';\nimport Icon from '@mdi/react';\nimport { mdiSend, mdiDelete } from '@mdi/js';\n\nconst useStyles = makeStyles(() => ({\n    topMarg: {\n        marginTop: 100,\n    },\n    paper: {\n        maxWidth: 600,\n        margin: 'auto',\n    },\n    formMarg: {\n        marginTop: 40,\n    }\n}));\n\nfunction ThreadComponent(props) {\n    const classes = useStyles();\n    const params = useParams();\n    const history = useHistory();\n    const gridRef = useRef();\n    const [msg, setMsg] = useState(''); //Variable and setter for the chat message we send.\n    const [msgDeleting, setMsgDeleting] = useState(false); //Variable and setter to disable buttons when msg is sending or deleting.\n    const [thread, setThread] = useState(null); //Variable and setter for the message thread we receive from the server.\n\n    useEffect(() => {\n        //First check to see if the user is null. Go to login page if they are. \n        if(props.user === null) {\n            swal(\n                'Uh Oh!',\n                'You must be logged in to view a message thread!',\n                'error',\n            );\n            history.push('/');\n        }\n        else {\n            return axios({\n                method: 'GET',\n                url: `http://192.168.0.17:3001/api/grab/thread/${params.uniqueThreadId}`,\n            }).then(response => {\n                if(response.data === 'no thread') {\n                    swal(\n                        'Uh Oh!',\n                        'That message thread cannot be found!',\n                        'error',\n                    );\n                    history.goBack(1);\n                }\n                else {\n                    props.dispatch({type: 'user/updateUser', payload: response.data.user});\n                    props.dispatch({type: 'ThemeChange', payload: response.data.user.profileTheme});\n                    setThread([...response.data.thread]);\n                }\n            });\n        }\n    });\n\n    function timeDifference(date2, dateString) {\n        //This function will return whether or not we display something like \"2 hrs ago\" \"20 min ago\" or the date string for a thread\n        let date1 = Date.now();\n        let difference = date1 - date2;\n        let daysDifference = Math.floor(difference/1000/60/60/24);\n        let hoursDifference = Math.floor(difference/1000/60/60);\n        let minutesDifference = Math.floor(difference/1000/60);\n        let secondsDifference = Math.floor(difference/1000);\n        if(daysDifference > 0) {\n            return dateString;\n        }\n        else if(hoursDifference > 0 && hoursDifference < 23) {\n            return `${hoursDifference} hr ago`;\n        }\n        else if(minutesDifference > 0 && minutesDifference < 60) {\n            return `${minutesDifference} min ago`;\n        }\n        else if(minutesDifference === 0) {\n            return `${secondsDifference} secs ago`\n        }\n        else {\n            return dateString;\n        }\n    }\n\n    if(props.user !== null) {\n        return (\n            <Grid \n                container \n                className={classes.topMarg} \n            >\n                <Grid \n                    item \n                    xs={12}\n                >\n                    {(thread !== null && thread.messages.length > 0) &&\n                        <div>\n                            {thread.messages.map((message, index) => (\n                                <Paper \n                                    key={index.toString()} \n                                    elevation={3} \n                                    className={classes.paper} \n                                >\n                                    <ListItem \n                                        alignItems='flex-start' \n                                    >\n                                        <ListItemAvatar>\n                                            <Avatar \n                                                src={`http://192.168.0.17:3001/api/get/avatar/by/id/${message.senderUniqueUserId}`}\n                                                alt={`${message.senderUsername}`}\n                                                title={`${message.senderUsername}`} \n                                                onClick={e => history.push(`/geouser/${message.senderUniqueUserId}`)} \n                                            />\n                                        </ListItemAvatar>\n                                        <ListItemText \n                                            primary={\n                                                <div>\n                                                    <Typography \n                                                        variant='h6' \n                                                        component='h6' \n                                                    >\n                                                        {message.senderUsername}\n                                                    </Typography>\n                                                    <Typography \n                                                        variant='subtitle2' \n                                                        component='span' \n                                                        color='textSecondary' \n                                                    >\n                                                        {timeDifference(message.utcTime, message.dateString)}\n                                                    </Typography>\n                                                </div>\n                                            }\n                                            secondary={\n                                                <Typography \n                                                    variant='body1' \n                                                    component='p'\n                                                >\n                                                    {message.msg}\n                                                </Typography>\n                                            }\n                                        />\n                                        <ListItemSecondaryAction>\n                                            <IconButton \n                                                color='primary'\n                                            >\n                                                <Icon \n                                                    path={mdiDelete} \n                                                    size={1} \n                                                    title='Message delete' \n                                                    aria-label='Message delete' \n                                                />\n                                            </IconButton>\n                                        </ListItemSecondaryAction>\n                                    </ListItem>\n                                </Paper>\n                            ))}\n                        </div>\n                    }\n                </Grid>\n                {/* End of the messages Grid. Now add a GridRef for sliding purposes */} \n                <div \n                    ref={gridRef} \n                >\n\n                </div>\n                {/* Now, add the Grid for the TextField to send messages */} \n                <Grid \n                    item \n                    xs={12} \n                    className={classes.formMarg} \n                >\n                    <TextField \n                        label='Message' \n                        value={msg} \n                        onChange={e => setMsg(e.target.value)} \n                        color='primary' \n                        variant='outlined' \n                        placeholder='Send message...' \n                        helperText='Send a message to this user' \n                        inputLabelProps={{\n                            shrink: true,\n                        }}\n                        InputProps={{\n                            endAdornment: (\n                              <InputAdornment position='end'>\n                                <IconButton\n                                  aria-label='Message send button'\n                                  color='primary'\n                                >\n                                    <Icon \n                                        path={mdiSend}\n                                        size={2}\n                                    />\n                                </IconButton>\n                              </InputAdornment>\n                            ),\n                          }}\n                        multiline\n                        rows={4} \n                        fullWidth\n                    />\n                </Grid>\n            </Grid>\n        );\n    }\n    else {\n        return (\n            <Backdrop \n                open={true} \n            >\n                <CircularProgress \n                    color='primary' \n                />\n            </Backdrop>\n        );\n    }\n}\n\nfunction mapStateToProps(state) {\n    return {\n        user: state.userReducer.user,\n        primary: state.userThemeReducer.primary,\n    };\n}\n\nexport default connect(mapStateToProps)(ThreadComponent);"]},"metadata":{},"sourceType":"module"}